<!-- Loading Book -->
<app-loading *ngIf="loading" [message]="'common.loading' | translate"></app-loading>

<main class="container" *ngIf="book; else loadingOrNotFound">
  <!-- Breadcrumbs -->
  <div class="breadcrumbs">
    <a [routerLink]="'/'" class="breadcrumb-link">{{ 'common.home' | translate }}</a>
    <span class="breadcrumb-separator">/</span>
    <a [routerLink]="['/books', book.categoryId]" class="breadcrumb-link">{{ categoryName }}</a>
    <span class="breadcrumb-current">{{ book.title }}</span>
  </div>

  <!-- Product Section -->
  <section class="product-section">
    <!-- Book Cover -->
    <div class="book-cover-wrapper">
      <div class="book-cover" [style.background-image]="'url(' + book.images + ')'"></div>
    </div>

    <!-- Book Details -->
    <div class="book-details">
      <h1 class="book-title">{{ book.title }}</h1>
      <h2 class="book-author">
        {{ 'common.by' | translate }} {{ book.authorName }}
      </h2>
      <h2 class="book-author">{{ 'common.languages' | translate }}: {{ book.languages }}</h2>

      <!-- Description -->
      <p class="book-description">
        {{ book.description }}
      </p>

      <!-- Price -->
      <div class="price-wrapper">
        <span class="current-price">{{ book.price | currency }}</span>
      </div>

      <!-- Actions -->
      <div class="actions-wrapper">
        <!-- Quantity Selector -->
        <div class="quantity-selector">
          <button class="quantity-btn" (click)="decreaseQuantity()">-</button>
          <input type="text" class="quantity-input" [value]="quantity" readonly>
          <button class="quantity-btn" (click)="increaseQuantity()">+</button>
        </div>

        <!-- Add to Cart -->
        <button class="btn-add-cart" (click)="addToCart()">
          <span class="material-symbols-outlined">add_shopping_cart</span>
          {{ 'product.add_to_cart' | translate }}
        </button>

        <!-- Wishlist -->
        <button class="btn-wishlist" (click)="toggleWishlist()">
          <span class="material-symbols-outlined">
            {{ isInWishlist ? 'favorite' : 'favorite_border' }}
          </span>
        </button>
      </div>
    </div>
  </section>

  <!-- Tabs Section -->
  <section class="tabs-section">
    <nav class="tabs-nav">
      <a class="tab-link"
         [class.active]="activeTab === 'description'"
         (click)="setActiveTab('description')">
        {{ 'tabs.description' | translate }}
      </a>
      <a class="tab-link"
         [class.active]="activeTab === 'details'"
         (click)="setActiveTab('details')">
        {{ 'tabs.details' | translate }}
      </a>
      <a class="tab-link"
         [class.active]="activeTab === 'author'"
         (click)="setActiveTab('author')">
        {{ 'tabs.author' | translate }}
      </a>
    </nav>

    <!-- Description Tab -->
    <div class="tab-content" *ngIf="activeTab === 'description'">
      <p>{{ book.summaries }}</p>
    </div>

    <!-- Product Details Tab -->
    <div class="tab-content" *ngIf="activeTab === 'details'">
      <p>{{ book.subjects }}</p>
    </div>

    <!-- About Author Tab -->
    <div class="tab-content" *ngIf="activeTab === 'author'">
      <div *ngFor="let a of book.authors" class="author-box">
        <h3>{{ a.name }}</h3>
        <p *ngIf="a.birth_year">{{ 'author.born' | translate }}: {{ a.birth_year }}</p>
        <p *ngIf="a.death_year">{{ 'author.died' | translate }}: {{ a.death_year }}</p>
        <p *ngIf="!a.birth_year && !a.death_year">
          {{ 'author.no_info' | translate }}
        </p>
      </div>
    </div>
  </section>
</main>

<ng-template #loadingOrNotFound>
  <div *ngIf="!loading && !book" class="not-found">
    <h2>{{ 'errors.book_not_found' | translate }}</h2>
    <a routerLink="/home" class="btn-back">{{ 'common.back_to_home' | translate }}</a>
  </div>
</ng-template>
